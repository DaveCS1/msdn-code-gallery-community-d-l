<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=62DBC035A4A8AD76676CA11B61CB6C59" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a81f3dc2-861d-4776-a98c-4d05a1c9ff24Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=60546B18CCC226DE9D7A404EDD74623E" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Dynamic where conditions with LINQ/Lambda</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Dynamic where conditions with LINQ/Lambda</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            LINQ, Lambda Expressions
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            LINQ to Objects, Data Access
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/14/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Dynamic-where-conditions-ca0ac8c4">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1><span style="font-size:20px; font-weight:bold">Description</span></h1>
<p><span style="font-size:small">This article show how to dynamically create multiple conditions in the where part of a LINQ statement where the key point is we don't know if the user is going to filter on just one field/column or more.&nbsp; If we knew than
 our life is easy. If you search around the Internet it appears that you can only have one where clause, no different than conventional database SQL.</span>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">Dim MexicoOwners =
    (
        From T In ResultsConventionalLinQ
        Where T.ContactType = &quot;Owner&quot; AndAlso T.Country = &quot;Mexico&quot;
        Select T
    ).ToList.</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Dim</span>&nbsp;MexicoOwners&nbsp;=&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;T&nbsp;<span class="visualBasic__keyword">In</span>&nbsp;ResultsConventionalLinQ&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Where&nbsp;T.ContactType&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Owner&quot;</span>&nbsp;<span class="visualBasic__keyword">AndAlso</span>&nbsp;T.Country&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Mexico&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Select</span>&nbsp;T&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;).ToList.</pre>
</div>
</div>
</div>
<p><span style="font-size:small">The next code block queries a strong typed list with two conditions in the where section. If the user only wanted to filter on one condition we could check then in an if statement use the appropriate statement. That is all well
 and good until you need to do filtering on say a handful of fields in a dynamic manner. LINQ/Lambda is not going to help in the conventional way as we are still restricted similarly are above.</span></p>
<p><span style="font-size:small">&nbsp;</span></p>
<p><span style="font-size:small"></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">Dim ResultsConventionalLambda As IEnumerable(Of Customer) =
    (
        From T In XDocument.Load(FileName)...&lt;Customer&gt;
        Select New Customer With
               {
                   .Identifier = T.&lt;CustomerID&gt;.Value,
                   .CompanyName = T.&lt;CompanyName&gt;.Value,
                   .ContactType = T.&lt;ContactTitle&gt;.Value,
                   .Country = T.&lt;Country&gt;.Value
               }
    ).Where(
    Function(x)
        Return x.ContactType = ContactType AndAlso x.Country = Country
    End Function).ToList</pre>
<div class="preview">
<pre class="js">Dim&nbsp;ResultsConventionalLambda&nbsp;As&nbsp;IEnumerable(Of&nbsp;Customer)&nbsp;=&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;T&nbsp;In&nbsp;XDocument.Load(FileName)...&lt;Customer&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;New&nbsp;Customer&nbsp;With&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Identifier&nbsp;=&nbsp;T.&lt;CustomerID&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.CompanyName&nbsp;=&nbsp;T.&lt;CompanyName&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ContactType&nbsp;=&nbsp;T.&lt;ContactTitle&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Country&nbsp;=&nbsp;T.&lt;Country&gt;.Value&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;).Where(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__object">Function</span>(x)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;x.ContactType&nbsp;=&nbsp;ContactType&nbsp;AndAlso&nbsp;x.Country&nbsp;=&nbsp;Country&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;<span class="js__object">Function</span>).ToList</pre>
</div>
</div>
</div>
</span>
<p></p>
<p><span style="font-size:small">The solution to make additive where conditions work is extremely simple. Create a LINQ statement that selects your data. Next check which fields/columns the user wants to filter on and simple assign a Lambda statement to the
 original LINQ statement. The code block below is an excert from the attached demostration project<br>
<br>
</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">Dim Results As IEnumerable(Of Customer) =
    (
        From T In XDocument.Load(FileName)...&lt;Customer&gt;
        Select New Customer With
               {
                   .Identifier = T.&lt;CustomerID&gt;.Value,
                   .CompanyName = T.&lt;CompanyName&gt;.Value,
                   .ContactType = T.&lt;ContactTitle&gt;.Value,
                   .Country = T.&lt;Country&gt;.Value
               }
           )

If Not CompanyName.Equals(&quot;All&quot;) Then
    Results = Results.Where(Function(x) x.CompanyName = CompanyName)
End If

If Not ContactType.Equals(&quot;All&quot;) Then
    Results = Results.Where(Function(x) x.ContactType = ContactType)
End If

If Not Country.Equals(&quot;All&quot;) Then
    Results = Results.Where(Function(x) x.Country = Country)
End If</pre>
<div class="preview">
<pre class="js">Dim&nbsp;Results&nbsp;As&nbsp;IEnumerable(Of&nbsp;Customer)&nbsp;=&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;T&nbsp;In&nbsp;XDocument.Load(FileName)...&lt;Customer&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;New&nbsp;Customer&nbsp;With&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Identifier&nbsp;=&nbsp;T.&lt;CustomerID&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.CompanyName&nbsp;=&nbsp;T.&lt;CompanyName&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ContactType&nbsp;=&nbsp;T.&lt;ContactTitle&gt;.Value,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Country&nbsp;=&nbsp;T.&lt;Country&gt;.Value&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;
If&nbsp;Not&nbsp;CompanyName.Equals(<span class="js__string">&quot;All&quot;</span>)&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Results&nbsp;=&nbsp;Results.Where(<span class="js__object">Function</span>(x)&nbsp;x.CompanyName&nbsp;=&nbsp;CompanyName)&nbsp;
End&nbsp;If&nbsp;
&nbsp;
If&nbsp;Not&nbsp;ContactType.Equals(<span class="js__string">&quot;All&quot;</span>)&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Results&nbsp;=&nbsp;Results.Where(<span class="js__object">Function</span>(x)&nbsp;x.ContactType&nbsp;=&nbsp;ContactType)&nbsp;
End&nbsp;If&nbsp;
&nbsp;
If&nbsp;Not&nbsp;Country.Equals(<span class="js__string">&quot;All&quot;</span>)&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Results&nbsp;=&nbsp;Results.Where(<span class="js__object">Function</span>(x)&nbsp;x.Country&nbsp;=&nbsp;Country)&nbsp;
End&nbsp;If</pre>
</div>
</div>
</div>
<div class="endscriptcode">So I invite you to download the solution, give a quick run through of the code, build/run to see how it all works.<br>
<br>
<img id="123796" src="description/aaaaa.png" alt="" width="703" height="430"></div>
</span>
<p></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><br>
<img id="123797" src="description/bbbbbb.png" alt="" width="369" height="319"><br>
<br>
<br>
</span></p>

</div>


    </div>
</body>
</html>
