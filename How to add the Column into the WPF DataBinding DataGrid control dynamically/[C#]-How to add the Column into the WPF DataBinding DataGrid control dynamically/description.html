<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7bd86db-8a7a-43ce-8954-21f8f839f51bCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to add the Column into the WPF DataBinding DataGrid control dynamically</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to add the Column into the WPF DataBinding DataGrid control dynamically</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            WPF
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            DataGrid, Data Binding, WPF Data Binding, dynamic Type, DataGrid Binding
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">9/11/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/How-to-add-the-Column-into-2ad31c47">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p>This sample DEMOs how to add the column into the DataGrid which is bound to one Collection or one DataTable.</p>
<h1><span>Building the Sample</span></h1>
<p>There are two projects in this sample, one for binding the Collection object on the DataGrid, and the other for binding the DataTable to the DataGrid. In the Collection object, I use the dynamic type, so you have to build the first project in the .Net 4
 Framework and work in WPF 4. The second project can work in the .Net 3.5 and 4 both, in the .Net 3.5 Framework, we could use the WPF Toolkit DataGrid to replace the build-in DataGrid control in WPF 4.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p>This sample DEMOs how to add the column into the DataGrid which is bound to one Collection or one DataTable.</p>
<p>As we knoe, in WPF, DataGird is one ItemsControl and it only supports the DataGridRows, (the DataGridRow supports to contain the DataGridCells in it). So we cannot get the columns in the DataGrid at the run-time, the DataGrid does not have the column structure
 in its Visual Tree. But we could generate the column automatically by setting the property<span style="color:#000000"> AutoGenerateColumns to True</span><em><span style="color:#000000">.</span></em><span style="color:#000000"> So if we could dynamically add
 the Column into the bound DataTable, the DataGrid should show the changes by refresh its DataBinding.</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">编辑脚本</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">    private void AddRow_Click(object sender, RoutedEventArgs e) 
    { 
      DataRow dr = dt.NewRow(); 
      for (int columIndex = 0; columIndex &lt; dt.Columns.Count; columIndex&#43;&#43;) 
        dr[columIndex] = &quot;New Row - &quot; &#43; columIndex.ToString(); 
      dt.Rows.Add(dr); 
    } 
 
    int newColumnIndex = 1; 
    private void AddColumn_Click(object sender, RoutedEventArgs e) 
    { 
      dt.Columns.Add(new DataColumn(&quot;New Column&quot; &#43; newColumnIndex&#43;&#43;)); 
      for (int i = 0; i &lt; dt.Rows.Count; i&#43;&#43;) 
      { 
        dt.Rows[i][dt.Columns.Count - 1] = i.ToString() &#43; &quot; - New Column&quot;; 
      } 
 
      // Refresh the DataGrid 
      dataGrid.ItemsSource = null; 
      dataGrid.ItemsSource = dt.DefaultView; 
    } 
</pre>
<div class="preview">
<pre class="js">&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="js__operator">void</span>&nbsp;AddRow_Click(object&nbsp;sender,&nbsp;RoutedEventArgs&nbsp;e)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataRow&nbsp;dr&nbsp;=&nbsp;dt.NewRow();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">for</span>&nbsp;(int&nbsp;columIndex&nbsp;=&nbsp;<span class="js__num">0</span>;&nbsp;columIndex&nbsp;&lt;&nbsp;dt.Columns.Count;&nbsp;columIndex&#43;&#43;)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dr[columIndex]&nbsp;=&nbsp;<span class="js__string">&quot;New&nbsp;Row&nbsp;-&nbsp;&quot;</span>&nbsp;&#43;&nbsp;columIndex.ToString();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt.Rows.Add(dr);&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;newColumnIndex&nbsp;=&nbsp;<span class="js__num">1</span>;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="js__operator">void</span>&nbsp;AddColumn_Click(object&nbsp;sender,&nbsp;RoutedEventArgs&nbsp;e)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt.Columns.Add(<span class="js__operator">new</span>&nbsp;DataColumn(<span class="js__string">&quot;New&nbsp;Column&quot;</span>&nbsp;&#43;&nbsp;newColumnIndex&#43;&#43;));&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">for</span>&nbsp;(int&nbsp;i&nbsp;=&nbsp;<span class="js__num">0</span>;&nbsp;i&nbsp;&lt;&nbsp;dt.Rows.Count;&nbsp;i&#43;&#43;)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt.Rows[i][dt.Columns.Count&nbsp;-&nbsp;<span class="js__num">1</span>]&nbsp;=&nbsp;i.ToString()&nbsp;&#43;&nbsp;<span class="js__string">&quot;&nbsp;-&nbsp;New&nbsp;Column&quot;</span>;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__sl_comment">//&nbsp;Refresh&nbsp;the&nbsp;DataGrid&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.ItemsSource&nbsp;=&nbsp;null;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.ItemsSource&nbsp;=&nbsp;dt.DefaultView;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<p><span style="color:#000000">&nbsp;</span></p>
<hr>
<p>&nbsp;</p>
<p>If you want to bind the object collection to the DataGrid, not use the DataTable. I could recommend you use reference the new freature of .Net 4-- dynamic type:
<a href="http://msdn.microsoft.com/en-us/library/dd264736.aspx">http://msdn.microsoft.com/en-us/library/dd264736.aspx</a>&nbsp;and WPF 4 alose supports to bind the dynamic object:
<a href="http://blogs.msdn.com/b/llobo/archive/2009/11/02/new-wpf-feature-binding-to-dynamic-objects.aspx">
http://blogs.msdn.com/b/llobo/archive/2009/11/02/new-wpf-feature-binding-to-dynamic-objects.aspx</a>&nbsp;</p>
<p>In the dynamic object, we could add the new properties at run-time, and add the new column into the DataGrid to bind to the new property.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">编辑脚本</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">    private IEnumerable&lt;string&gt; PropertyNames;

    public MainWindow()
    {
      InitializeComponent();

      PropertyNames = new List&lt;string&gt;();

      for (int i = 0; i &lt; 5; i&#43;&#43;)
      {
        dynamic item = new DynamicObjectClass();
        item.A = &quot;Property A value - &quot; &#43; i.ToString();
        item.B = &quot;Property B value - &quot; &#43; i.ToString();

        PropertyNames = item.GetDynamicMemberNames();
        items.Add(item);
      }

      //Add Columns
      dataGrid.Columns.Add(new DataGridTextColumn() {Header=&quot;A&quot;, Binding = new Binding(&quot;A&quot;) });
      dataGrid.Columns.Add(new DataGridTextColumn() {Header=&quot;B&quot;, Binding = new Binding(&quot;B&quot;) });
      dataGrid.ItemsSource = items;
    }

    private void AddRow_Click(object sender, RoutedEventArgs e)
    {
      dynamic item = new DynamicObjectClass();
      foreach (string PropertyName in PropertyNames)
      {
        item.TrySetMember(new SetPropertyBinder(PropertyName), &quot;New Item - &quot; &#43; PropertyName);
      }
      items.Add(item);
    }

    int newColumnIndex = 1;
    private void AddColumn_Click(object sender, RoutedEventArgs e)
    {
      foreach (DynamicObjectClass item in items)
      {
        item.TrySetMember(new SetPropertyBinder(&quot;NewColumn&quot; &#43; newColumnIndex), &quot;New Column Value - &quot; &#43; newColumnIndex.ToString());
        PropertyNames = item.GetDynamicMemberNames();
      }

      dataGrid.Columns.Add(new DataGridTextColumn() { Header = &quot;New Column&quot; &#43; newColumnIndex, Binding = new Binding(&quot;NewColumn&quot; &#43; newColumnIndex) });

      newColumnIndex&#43;&#43;;
    }</pre>
<div class="preview">
<pre class="js">&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;IEnumerable&lt;string&gt;&nbsp;PropertyNames;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MainWindow()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyNames&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;List&lt;string&gt;();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">for</span>&nbsp;(int&nbsp;i&nbsp;=&nbsp;<span class="js__num">0</span>;&nbsp;i&nbsp;&lt;&nbsp;<span class="js__num">5</span>;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamic&nbsp;item&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;DynamicObjectClass();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.A&nbsp;=&nbsp;<span class="js__string">&quot;Property&nbsp;A&nbsp;value&nbsp;-&nbsp;&quot;</span>&nbsp;&#43;&nbsp;i.ToString();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.B&nbsp;=&nbsp;<span class="js__string">&quot;Property&nbsp;B&nbsp;value&nbsp;-&nbsp;&quot;</span>&nbsp;&#43;&nbsp;i.ToString();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyNames&nbsp;=&nbsp;item.GetDynamicMemberNames();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;items.Add(item);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__sl_comment">//Add&nbsp;Columns</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.Columns.Add(<span class="js__operator">new</span>&nbsp;DataGridTextColumn()&nbsp;<span class="js__brace">{</span>Header=<span class="js__string">&quot;A&quot;</span>,&nbsp;Binding&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Binding(<span class="js__string">&quot;A&quot;</span>)&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.Columns.Add(<span class="js__operator">new</span>&nbsp;DataGridTextColumn()&nbsp;<span class="js__brace">{</span>Header=<span class="js__string">&quot;B&quot;</span>,&nbsp;Binding&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Binding(<span class="js__string">&quot;B&quot;</span>)&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.ItemsSource&nbsp;=&nbsp;items;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="js__operator">void</span>&nbsp;AddRow_Click(object&nbsp;sender,&nbsp;RoutedEventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamic&nbsp;item&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;DynamicObjectClass();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(string&nbsp;PropertyName&nbsp;<span class="js__operator">in</span>&nbsp;PropertyNames)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.TrySetMember(<span class="js__operator">new</span>&nbsp;SetPropertyBinder(PropertyName),&nbsp;<span class="js__string">&quot;New&nbsp;Item&nbsp;-&nbsp;&quot;</span>&nbsp;&#43;&nbsp;PropertyName);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;items.Add(item);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;newColumnIndex&nbsp;=&nbsp;<span class="js__num">1</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;<span class="js__operator">void</span>&nbsp;AddColumn_Click(object&nbsp;sender,&nbsp;RoutedEventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(DynamicObjectClass&nbsp;item&nbsp;<span class="js__operator">in</span>&nbsp;items)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.TrySetMember(<span class="js__operator">new</span>&nbsp;SetPropertyBinder(<span class="js__string">&quot;NewColumn&quot;</span>&nbsp;&#43;&nbsp;newColumnIndex),&nbsp;<span class="js__string">&quot;New&nbsp;Column&nbsp;Value&nbsp;-&nbsp;&quot;</span>&nbsp;&#43;&nbsp;newColumnIndex.ToString());&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyNames&nbsp;=&nbsp;item.GetDynamicMemberNames();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataGrid.Columns.Add(<span class="js__operator">new</span>&nbsp;DataGridTextColumn()&nbsp;<span class="js__brace">{</span>&nbsp;Header&nbsp;=&nbsp;<span class="js__string">&quot;New&nbsp;Column&quot;</span>&nbsp;&#43;&nbsp;newColumnIndex,&nbsp;Binding&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Binding(<span class="js__string">&quot;NewColumn&quot;</span>&nbsp;&#43;&nbsp;newColumnIndex)&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newColumnIndex&#43;&#43;;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"></div>
<h1>More Information</h1>
<p>&nbsp;And in this sample, I use one DynamicObjectClass, please refer to: <a href="http://blogs.msdn.com/b/llobo/archive/2009/11/02/new-wpf-feature-binding-to-dynamic-objects.aspx">
http://blogs.msdn.com/b/llobo/archive/2009/11/02/new-wpf-feature-binding-to-dynamic-objects.aspx</a></p>

</div>


    </div>
</body>
</html>
