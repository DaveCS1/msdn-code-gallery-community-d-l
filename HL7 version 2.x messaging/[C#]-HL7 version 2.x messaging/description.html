<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=EC831D2F780A53CF4C404B53E768954F" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/6cbfb7bc-07a2-4743-be43-4495f3cdd504Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=DF234F4FF3DA5D35A03D2829D4F99E0D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>HL7 version 2.x messaging</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>HL7 version 2.x messaging</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, Sockets, Network
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            healthcare, Messaging, Interoperabilit<wbr />y, HL7
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">7/6/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/HL7-version-2x-messaging-d429fbee">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>
<div class="endscriptcode">&nbsp;</div>
Introduction</h1>
<p>This is an example for a very simple implementation of an HL7 message server. The server waits on a network socket for incoming connections and looks for a valid MLLP frame. When such a data frame has been found the contained data is unpacked and parsed
 into an HL7 message. After the HL7 message has been processed the server sends automatically an acknowledgment back over the network and closes the connection.</p>
<h1><span>Building the Sample</span></h1>
<p>The sample has no dependencies to other libraries. Just build the sample code in Visual Studio. The solution contains one portable class library for parsing and building HL7 version 2.x messages. You can use the library in your own projects. It is licensed
 unter the Apache 2.0 licsense terms.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p>The example contains a library for parsing text into a HL7 message object. Simply call the method&nbsp;Parse()&nbsp;</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">// the string data holds the HL7 Version 2.x message text  

var msg = new Message();
msg.Parse(data);

Console.WriteLine(&quot;Parsed message     : {0}&quot;, msg.MessageType() );
Console.WriteLine(&quot;Message timestamp  : {0}&quot;, msg.MessageDateTime() );
Console.WriteLine(&quot;Message control id : {0}&quot;, msg.MessageControlId());</pre>
<div class="preview">
<pre class="csharp"><span class="cs__com">//&nbsp;the&nbsp;string&nbsp;data&nbsp;holds&nbsp;the&nbsp;HL7&nbsp;Version&nbsp;2.x&nbsp;message&nbsp;text&nbsp;&nbsp;</span>&nbsp;
&nbsp;
var&nbsp;msg&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;Message();&nbsp;
msg.Parse(data);&nbsp;
&nbsp;
Console.WriteLine(<span class="cs__string">&quot;Parsed&nbsp;message&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{0}&quot;</span>,&nbsp;msg.MessageType()&nbsp;);&nbsp;
Console.WriteLine(<span class="cs__string">&quot;Message&nbsp;timestamp&nbsp;&nbsp;:&nbsp;{0}&quot;</span>,&nbsp;msg.MessageDateTime()&nbsp;);&nbsp;
Console.WriteLine(<span class="cs__string">&quot;Message&nbsp;control&nbsp;id&nbsp;:&nbsp;{0}&quot;</span>,&nbsp;msg.MessageControlId());</pre>
</div>
</div>
</div>
<p>An HL7 message consists of a sequence of segments. Each segment contains a number of fields, which can be divided even further into smaller parts. The example supports only Segments and Fields, but it is easy to extend.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">// Create a response message
//
var response = new Message();

var msh = new Segment(&quot;MSH&quot;);
msh.Field(2, &quot;^~\\&amp;&quot;);
msh.Field(7, DateTime.Now.ToString(&quot;yyyyMMddhhmmsszzz&quot;));
msh.Field(9, &quot;ACK&quot;);
msh.Field(10, Guid.NewGuid().ToString() );
msh.Field(11, &quot;P&quot;);
msh.Field(12, &quot;2.5.1&quot;);
response.Add(msh);

var msa = new Segment(&quot;MSA&quot;);
msa.Field(1, &quot;AA&quot;);
msa.Field(2, msg.MessageControlId());
response.Add(msa);
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__com">//&nbsp;Create&nbsp;a&nbsp;response&nbsp;message</span>&nbsp;
<span class="cs__com">//</span>&nbsp;
var&nbsp;response&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;Message();&nbsp;
&nbsp;
var&nbsp;msh&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;Segment(<span class="cs__string">&quot;MSH&quot;</span>);&nbsp;
msh.Field(<span class="cs__number">2</span>,&nbsp;<span class="cs__string">&quot;^~\\&amp;&quot;</span>);&nbsp;
msh.Field(<span class="cs__number">7</span>,&nbsp;DateTime.Now.ToString(<span class="cs__string">&quot;yyyyMMddhhmmsszzz&quot;</span>));&nbsp;
msh.Field(<span class="cs__number">9</span>,&nbsp;<span class="cs__string">&quot;ACK&quot;</span>);&nbsp;
msh.Field(<span class="cs__number">10</span>,&nbsp;Guid.NewGuid().ToString()&nbsp;);&nbsp;
msh.Field(<span class="cs__number">11</span>,&nbsp;<span class="cs__string">&quot;P&quot;</span>);&nbsp;
msh.Field(<span class="cs__number">12</span>,&nbsp;<span class="cs__string">&quot;2.5.1&quot;</span>);&nbsp;
response.Add(msh);&nbsp;
&nbsp;
var&nbsp;msa&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;Segment(<span class="cs__string">&quot;MSA&quot;</span>);&nbsp;
msa.Field(<span class="cs__number">1</span>,&nbsp;<span class="cs__string">&quot;AA&quot;</span>);&nbsp;
msa.Field(<span class="cs__number">2</span>,&nbsp;msg.MessageControlId());&nbsp;
response.Add(msa);&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<h1>More Information</h1>
<p>Further information about HL7 version 2.x messaging can be found on <a href="http://www.hl7.org">
http://www.hl7.org</a>. Please note that the HL7 organisation has issued several standards and made them publicly available. Further help for implemeting HL7 messaging is provided by the IHE
<a href="http://www.ihe.net">http://www.ihe.net</a>.</p>

</div>


    </div>
</body>
</html>
