<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/0aac1760-b513-488a-ba57-e31d9413a075Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>LinkedIn OAuth 1.0a Example</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>LinkedIn OAuth 1.0a Example</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            XAML, HttpClient
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            OAuth, LinkedIn
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/26/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/LinkedIn-OAuth-Example-c06d64f5">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p><span style="text-decoration:underline"><strong><span style="font-size:large">Introduction</span></strong></span></p>
<p><span style="font-size:small">&nbsp;An example of how to have an app communicating with LinkedIn API through OAuth.</span></p>
<p><span style="text-decoration:underline"><strong><span style="font-size:large">Description</span></strong></span></p>
<p><span style="font-size:small">LinkedIn is using a strict OAuth 1.0a and requires HTTP Header-based Authorization. Before we start coding, let&rsquo;s talk briefly what our application (i.e., LinkedIn consumer) has to do to be able to consume LinkedIn information
 with user authorization.</span></p>
<p><span style="font-size:small">1. Our application has to have a LinkedIn consumer key and consumer secret key. We can get it by registering your app thru LinkedIn Developer Network.</span></p>
<p><span style="font-size:small">2. Our application starts talking with LinkedIn by asking LinkedIn for a request token (and request token secret key). In this step, our application has to give Linkedin, the consumer key and other OAuth information like nonce,
 signature method, version, and so on. The application also needs to provide a signature which is signed with the consumer secret key.</span></p>
<p><span style="font-size:small">3. Beside the request token and the request token secret key, LinkedIn will also give us an authorize link which allows users to (authenticate himself/herself if necessary) authorize our application.</span></p>
<p><span style="font-size:small">4. As our application is not a web application (as specified when we register our application), our application has to provide a way for user to enter a PIN code that LinkedIn gives the user in authorization process.</span></p>
<p><span style="font-size:small">5. Now our application should have the request token, the request token secret key, the PIN code (oauth_verifier). Our application will use above information to request LinkedIn for an access token and an access token secret
 key. The application also needs to provide a signature which is signed with the consumer secret and request token secret keys.</span></p>
<p><span style="font-size:small">6. Once our application has the access token and the access token secret key, then our application can make LinkedIn API call and get information from LinkedIn.</span></p>
<p><span style="font-size:small">Here are screenshots of the app.</span></p>
<p>&nbsp;</p>
<p><span style="font-size:small">a. Get RequestToken</span></p>
<p>&nbsp;<img id="65100" src="description/first-screen.jpg" alt="" width="683" height="384"></p>
<p><span><em>&nbsp;</em></span><span style="font-size:small">&nbsp;b. Get AccesToken</span></p>
<p><img id="65101" src="description/second-screen.jpg" alt="" width="683" height="384"></p>
<p><span style="font-size:small"><em>c. Access LinkedIn API</em></span></p>
<p><span><em><img id="65102" src="description/third-screen.jpg" alt="" width="683" height="384"></em></span></p>
<p><span><em></em></span>&nbsp;</p>
<p><span><em>2. Show&nbsp;code&nbsp;that communicates with LinkedIn through OAuth. Several OAuth helper methods are from Web authentication broker sample.</em></span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">private async void getRequestToken_Click_1(object sender, RoutedEventArgs e)
{
    string nonce = oAuthUtil.GetNonce();
    string timeStamp = oAuthUtil.GetTimeStamp();

    string sigBaseStringParams = &quot;oauth_consumer_key=&quot; &#43; consumerKey.Text;

    sigBaseStringParams &#43;= &quot;&amp;&quot; &#43; &quot;oauth_nonce=&quot; &#43; nonce;
    sigBaseStringParams &#43;= &quot;&amp;&quot; &#43; &quot;oauth_signature_method=&quot; &#43; &quot;HMAC-SHA1&quot;;
    sigBaseStringParams &#43;= &quot;&amp;&quot; &#43; &quot;oauth_timestamp=&quot; &#43; timeStamp;
    sigBaseStringParams &#43;= &quot;&amp;&quot; &#43; &quot;oauth_version=1.0&quot;;
    string sigBaseString = &quot;POST&amp;&quot;;
    sigBaseString &#43;= Uri.EscapeDataString(_linkedInRequestTokenUrl) &#43; &quot;&amp;&quot; &#43; Uri.EscapeDataString(sigBaseStringParams);

    string signature = oAuthUtil.GetSignature(sigBaseString, consumerSecretKey.Text);

    var responseText = await oAuthUtil.PostData(_linkedInRequestTokenUrl, sigBaseStringParams &#43; &quot;&amp;oauth_signature=&quot; &#43; Uri.EscapeDataString(signature));

    if (!string.IsNullOrEmpty(responseText))
    {
        string oauth_token = null;
        string oauth_token_secret = null;
        string oauth_authorize_url = null;
        string[] keyValPairs = responseText.Split('&amp;');

        for (int i = 0; i &lt; keyValPairs.Length; i&#43;&#43;)
        {
            String[] splits = keyValPairs[i].Split('=');
            switch (splits[0])
            {
                case &quot;oauth_token&quot;:
                    oauth_token = splits[1];
                    break;
                case &quot;oauth_token_secret&quot;:
                    oauth_token_secret = splits[1];
                    break;
                case &quot;xoauth_request_auth_url&quot;:
                    oauth_authorize_url = splits[1];
                    break;
            }
        }

        requestToken.Text = oauth_token;
        requestTokenSecretKey.Text = oauth_token_secret;
        oAuthAuthorizeLink.Content = Uri.UnescapeDataString(oauth_authorize_url &#43; &quot;?oauth_token=&quot; &#43; oauth_token);
    }
}
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">private</span>&nbsp;async&nbsp;<span class="cs__keyword">void</span>&nbsp;getRequestToken_Click_1(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;RoutedEventArgs&nbsp;e)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;nonce&nbsp;=&nbsp;oAuthUtil.GetNonce();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;timeStamp&nbsp;=&nbsp;oAuthUtil.GetTimeStamp();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;sigBaseStringParams&nbsp;=&nbsp;<span class="cs__string">&quot;oauth_consumer_key=&quot;</span>&nbsp;&#43;&nbsp;consumerKey.Text;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sigBaseStringParams&nbsp;&#43;=&nbsp;<span class="cs__string">&quot;&amp;&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__string">&quot;oauth_nonce=&quot;</span>&nbsp;&#43;&nbsp;nonce;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sigBaseStringParams&nbsp;&#43;=&nbsp;<span class="cs__string">&quot;&amp;&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__string">&quot;oauth_signature_method=&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__string">&quot;HMAC-SHA1&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sigBaseStringParams&nbsp;&#43;=&nbsp;<span class="cs__string">&quot;&amp;&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__string">&quot;oauth_timestamp=&quot;</span>&nbsp;&#43;&nbsp;timeStamp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sigBaseStringParams&nbsp;&#43;=&nbsp;<span class="cs__string">&quot;&amp;&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__string">&quot;oauth_version=1.0&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;sigBaseString&nbsp;=&nbsp;<span class="cs__string">&quot;POST&amp;&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sigBaseString&nbsp;&#43;=&nbsp;Uri.EscapeDataString(_linkedInRequestTokenUrl)&nbsp;&#43;&nbsp;<span class="cs__string">&quot;&amp;&quot;</span>&nbsp;&#43;&nbsp;Uri.EscapeDataString(sigBaseStringParams);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;signature&nbsp;=&nbsp;oAuthUtil.GetSignature(sigBaseString,&nbsp;consumerSecretKey.Text);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;responseText&nbsp;=&nbsp;await&nbsp;oAuthUtil.PostData(_linkedInRequestTokenUrl,&nbsp;sigBaseStringParams&nbsp;&#43;&nbsp;<span class="cs__string">&quot;&amp;oauth_signature=&quot;</span>&nbsp;&#43;&nbsp;Uri.EscapeDataString(signature));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(!<span class="cs__keyword">string</span>.IsNullOrEmpty(responseText))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;oauth_token&nbsp;=&nbsp;<span class="cs__keyword">null</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;oauth_token_secret&nbsp;=&nbsp;<span class="cs__keyword">null</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;oauth_authorize_url&nbsp;=&nbsp;<span class="cs__keyword">null</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>[]&nbsp;keyValPairs&nbsp;=&nbsp;responseText.Split(<span class="cs__string">'&amp;'</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">for</span>&nbsp;(<span class="cs__keyword">int</span>&nbsp;i&nbsp;=&nbsp;<span class="cs__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;keyValPairs.Length;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;splits&nbsp;=&nbsp;keyValPairs[i].Split(<span class="cs__string">'='</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">switch</span>&nbsp;(splits[<span class="cs__number">0</span>])&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">case</span>&nbsp;<span class="cs__string">&quot;oauth_token&quot;</span>:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oauth_token&nbsp;=&nbsp;splits[<span class="cs__number">1</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">break</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">case</span>&nbsp;<span class="cs__string">&quot;oauth_token_secret&quot;</span>:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oauth_token_secret&nbsp;=&nbsp;splits[<span class="cs__number">1</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">break</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">case</span>&nbsp;<span class="cs__string">&quot;xoauth_request_auth_url&quot;</span>:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oauth_authorize_url&nbsp;=&nbsp;splits[<span class="cs__number">1</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">break</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requestToken.Text&nbsp;=&nbsp;oauth_token;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requestTokenSecretKey.Text&nbsp;=&nbsp;oauth_token_secret;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oAuthAuthorizeLink.Content&nbsp;=&nbsp;Uri.UnescapeDataString(oauth_authorize_url&nbsp;&#43;&nbsp;<span class="cs__string">&quot;?oauth_token=&quot;</span>&nbsp;&#43;&nbsp;oauth_token);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>MainPage.xaml and MainPage.xaml.cs&nbsp;- xaml and code-behind that drives the app.</em>
</li><li><em><em>OAuthUtil.cs&nbsp;- A utility class with OAuth helper methods (some are from Web authentication broker sample).</em></em>
</li></ul>
<h1>More Information</h1>
<p><em>For more information on the app, see <a href="http://cyanbyfuchsia.wordpress.com/2012/08/04/connect-your-metro-style-app-to-linkedin-via-oauth/">
http://cyanbyfuchsia.wordpress.com/2012/08/04/connect-your-metro-style-app-to-linkedin-via-oauth/</a></em></p>

</div>


    </div>
</body>
</html>
