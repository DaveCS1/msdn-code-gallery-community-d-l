<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/Header.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/sprite.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/UhfHeader.css" data-do-not-move="true" />
<link rel="stylesheet" href="https://statics-uhf-eus.akamaized.net/west-european/shell/_scrf/css/themes=default.device=uplevel_web_pc/45-b13dd1/f5-de8d13/67-d38eb4/13-93f898/bd-2afe85/af-f058b3/47-7e3522/2e-755ee8/88-d34e5c/21-fd5bc7/be-89ab9d/4a-45f526?ver=2.0" type="text/css" media="all" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:sprite,0:Footer,1:ImageSprite,2:SelectLocaleFromPopUp;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/WindowsApps/Content:1,/Areas/Epx/Themes/Base/Content:2&amp;amp;v=722535FCA5F445246BBA276D0A41BCB7" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Areas/Epx/Themes/Windows/Content/UhfFooter.css?v=636626369923802619" data-do-not-move="true" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>HTML to Image, JPG, PNG Converter for .NET and C# in ASP.NET, MVC and .NET Core</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/5210ebe3-5f96-40a1-a070-53330748bf8cBrand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/windowsapps/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/windowsapps/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>HTML to Image, JPG, PNG Converter for .NET and C# in ASP.NET, MVC and .NET Core</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, ASP.NET, Windows Forms, WPF, ASP.NET MVC, ASP.NET Web Forms, HTML to Image Converter, HTML to Jpeg Converter, HTML to PNG Converter, HTML to BMP Converter
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            HTML to Image Conversion, HTML to PNG Conversion, HTML to JPG Conversion, HTML to JPEG Conversion, HTML to TIFF Conversion
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">6/30/2018</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p>This sample project shows you how to integrate a HTML to Image Converter Library for .NET in your application to convert HTML documents, web pages and HTML code to various image formats.&nbsp;</p>
<p>The <a href="http://www.hiqpdf.com">HTML to Image Converter for .NET</a> allows you quickly take screenshots of your HTML documents and web pages. It can be easily integrated into any .NET application, either ASP.NET and MVC web applications or Windows Forms
 and WPF desktop applications to convert HTML to JPG, PNG, BMP or to TIFF.</p>
<p>When you convert to PNG you also have the option to create an image with transparent background. You can see a
<a href="http://www.hiqpdf.com/demo/ConvertHtmlToImage.aspx">HTML to Image for .NET live demo</a> where you can see all the converter settings at work.</p>
<h1><span>Building and Running the Sample</span></h1>
<p>To build the sample you have to open the Visual Studio solution and build the project. All the necessary files are referenced from NuGet and will be automatically copied from there. After build you can run the demo application in a browser.</p>
<p>The HTML to Image Converter is part of the HiQPdf HTML to PDF Converter Library for .NET and the project contains sample code for both usage scenarios.</p>
<p>&nbsp;</p>
<h1><em>HTML to Image Converter for .NET Features</em></h1>
<ul>
<li>Convert any HTML5 document or web pages to images </li><li>Convert HTML to JPEG, PNG, BMP or TIFF output formats </li><li>Option to create transparent PNG images </li><li>Easy to integrate in any .NET application </li><li>Fast response and very accurate output images </li><li>Options to select the output image width and height </li><li>Full support for JavaScript, CSS3, SVG and Web Fonts </li><li>Zero external dependencies </li></ul>
<p><em><br>
</em></p>
<p><span style="font-size:20px; font-weight:bold">C# Code Sample for ASP.NET to Convert HTML to Images</span></p>
<p>The minimal C# code to convert HTML to various image formats in ASP.NET will create a
<em>HtmlToImage </em>object and then it will call the <em>ConvertUrlToImage </em>
method to convert a HTML page from a given URL to image or will call the <em>ConvertHtmlToImage
</em>to convert a HTML code from a string to an image. The <em>ConvertHtmlToImage
</em>method also requires a base URL parameter to resolve the relative links to images and other files. The result of conversion is a
<em><a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e/https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e/https://msdn.microsoft.com/en-US/library/System.Drawing.Image.aspx"  title="Auto generated link to System.Drawing.Image">System.Drawing.Image</a></em> object which is saved to a memory buffer in one of the image formats supported by the .NET framework and then sent to browser for download.&nbsp; &nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">// create the HTML to Image converter
HtmlToImage htmlToImageConverter = new HtmlToImage();

// set browser width
htmlToImageConverter.BrowserWidth = int.Parse(textBoxBrowserWidth.Text);

// set browser height if specified, otherwise use the default
if (textBoxBrowserHeight.Text.Length &gt; 0)
    htmlToImageConverter.BrowserHeight = int.Parse(textBoxBrowserHeight.Text);

// set HTML Load timeout
htmlToImageConverter.HtmlLoadedTimeout = int.Parse(textBoxLoadHtmlTimeout.Text);

// set whether the resulted image is transparent (has effect only when the output format is PNG)
htmlToImageConverter.TransparentImage = (dropDownListImageFormat.SelectedValue == &quot;PNG&quot;) ?
            checkBoxTransparentImage.Checked : false;

// convert to image
<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e/https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e/https://msdn.microsoft.com/en-US/library/System.Drawing.Image.aspx"  title="Auto generated link to System.Drawing.Image">System.Drawing.Image</a> imageObject = null;
string imageFormatName = dropDownListImageFormat.SelectedValue.ToLower();
string imageFileName = String.Format(&quot;HtmlToImage.{0}&quot;, imageFormatName);

if (radioButtonConvertUrl.Checked)
{
    // convert URL
    string url = textBoxUrl.Text;

    imageObject = htmlToImageConverter.ConvertUrlToImage(url)[0];
}
else
{
    // convert HTML code
    string htmlCode = textBoxHtmlCode.Text;
    string baseUrl = textBoxBaseUrl.Text;

    imageObject = htmlToImageConverter.ConvertHtmlToImage(htmlCode, baseUrl)[0];
}

// get the image buffer in the selected image format
byte[] imageBuffer = GetImageBuffer(imageObject);

// the image object rturned by converter can be disposed
imageObject.Dispose();

// inform the browser about the binary data format
string mimeType = imageFormatName == &quot;jpg&quot; ? &quot;jpeg&quot; : imageFormatName;
HttpContext.Current.Response.AddHeader(&quot;Content-Type&quot;, &quot;image/&quot; &#43; mimeType);

// let the browser know how to open the image and the image name
HttpContext.Current.Response.AddHeader(&quot;Content-Disposition&quot;,
            String.Format(&quot;attachment; filename={0}; size={1}&quot;, imageFileName, imageBuffer.Length.ToString()));

// write the image buffer to HTTP response
HttpContext.Current.Response.BinaryWrite(imageBuffer);

// call End() method of HTTP response to stop ASP.NET page processing
HttpContext.Current.Response.End();Click here to add your code snippet.</pre>
<div class="preview">
<pre class="csharp"><span class="cs__com">//&nbsp;create&nbsp;the&nbsp;HTML&nbsp;to&nbsp;Image&nbsp;converter</span>&nbsp;
HtmlToImage&nbsp;htmlToImageConverter&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;HtmlToImage();&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;set&nbsp;browser&nbsp;width</span>&nbsp;
htmlToImageConverter.BrowserWidth&nbsp;=&nbsp;<span class="cs__keyword">int</span>.Parse(textBoxBrowserWidth.Text);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;set&nbsp;browser&nbsp;height&nbsp;if&nbsp;specified,&nbsp;otherwise&nbsp;use&nbsp;the&nbsp;default</span>&nbsp;
<span class="cs__keyword">if</span>&nbsp;(textBoxBrowserHeight.Text.Length&nbsp;&gt;&nbsp;<span class="cs__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;htmlToImageConverter.BrowserHeight&nbsp;=&nbsp;<span class="cs__keyword">int</span>.Parse(textBoxBrowserHeight.Text);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;set&nbsp;HTML&nbsp;Load&nbsp;timeout</span>&nbsp;
htmlToImageConverter.HtmlLoadedTimeout&nbsp;=&nbsp;<span class="cs__keyword">int</span>.Parse(textBoxLoadHtmlTimeout.Text);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;set&nbsp;whether&nbsp;the&nbsp;resulted&nbsp;image&nbsp;is&nbsp;transparent&nbsp;(has&nbsp;effect&nbsp;only&nbsp;when&nbsp;the&nbsp;output&nbsp;format&nbsp;is&nbsp;PNG)</span>&nbsp;
htmlToImageConverter.TransparentImage&nbsp;=&nbsp;(dropDownListImageFormat.SelectedValue&nbsp;==&nbsp;<span class="cs__string">&quot;PNG&quot;</span>)&nbsp;?&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkBoxTransparentImage.Checked&nbsp;:&nbsp;<span class="cs__keyword">false</span>;&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;convert&nbsp;to&nbsp;image</span>&nbsp;
System.Drawing.Image&nbsp;imageObject&nbsp;=&nbsp;<span class="cs__keyword">null</span>;&nbsp;
<span class="cs__keyword">string</span>&nbsp;imageFormatName&nbsp;=&nbsp;dropDownListImageFormat.SelectedValue.ToLower();&nbsp;
<span class="cs__keyword">string</span>&nbsp;imageFileName&nbsp;=&nbsp;String.Format(<span class="cs__string">&quot;HtmlToImage.{0}&quot;</span>,&nbsp;imageFormatName);&nbsp;
&nbsp;
<span class="cs__keyword">if</span>&nbsp;(radioButtonConvertUrl.Checked)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;convert&nbsp;URL</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;url&nbsp;=&nbsp;textBoxUrl.Text;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;imageObject&nbsp;=&nbsp;htmlToImageConverter.ConvertUrlToImage(url)[<span class="cs__number">0</span>];&nbsp;
}&nbsp;
<span class="cs__keyword">else</span>&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;convert&nbsp;HTML&nbsp;code</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;htmlCode&nbsp;=&nbsp;textBoxHtmlCode.Text;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;baseUrl&nbsp;=&nbsp;textBoxBaseUrl.Text;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;imageObject&nbsp;=&nbsp;htmlToImageConverter.ConvertHtmlToImage(htmlCode,&nbsp;baseUrl)[<span class="cs__number">0</span>];&nbsp;
}&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;get&nbsp;the&nbsp;image&nbsp;buffer&nbsp;in&nbsp;the&nbsp;selected&nbsp;image&nbsp;format</span>&nbsp;
<span class="cs__keyword">byte</span>[]&nbsp;imageBuffer&nbsp;=&nbsp;GetImageBuffer(imageObject);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;the&nbsp;image&nbsp;object&nbsp;rturned&nbsp;by&nbsp;converter&nbsp;can&nbsp;be&nbsp;disposed</span>&nbsp;
imageObject.Dispose();&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;inform&nbsp;the&nbsp;browser&nbsp;about&nbsp;the&nbsp;binary&nbsp;data&nbsp;format</span>&nbsp;
<span class="cs__keyword">string</span>&nbsp;mimeType&nbsp;=&nbsp;imageFormatName&nbsp;==&nbsp;<span class="cs__string">&quot;jpg&quot;</span>&nbsp;?&nbsp;<span class="cs__string">&quot;jpeg&quot;</span>&nbsp;:&nbsp;imageFormatName;&nbsp;
HttpContext.Current.Response.AddHeader(<span class="cs__string">&quot;Content-Type&quot;</span>,&nbsp;<span class="cs__string">&quot;image/&quot;</span>&nbsp;&#43;&nbsp;mimeType);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;let&nbsp;the&nbsp;browser&nbsp;know&nbsp;how&nbsp;to&nbsp;open&nbsp;the&nbsp;image&nbsp;and&nbsp;the&nbsp;image&nbsp;name</span>&nbsp;
HttpContext.Current.Response.AddHeader(<span class="cs__string">&quot;Content-Disposition&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.Format(<span class="cs__string">&quot;attachment;&nbsp;filename={0};&nbsp;size={1}&quot;</span>,&nbsp;imageFileName,&nbsp;imageBuffer.Length.ToString()));&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;write&nbsp;the&nbsp;image&nbsp;buffer&nbsp;to&nbsp;HTTP&nbsp;response</span>&nbsp;
HttpContext.Current.Response.BinaryWrite(imageBuffer);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;call&nbsp;End()&nbsp;method&nbsp;of&nbsp;HTTP&nbsp;response&nbsp;to&nbsp;stop&nbsp;ASP.NET&nbsp;page&nbsp;processing</span>&nbsp;
HttpContext.Current.Response.End();Click&nbsp;here&nbsp;to&nbsp;add&nbsp;your&nbsp;code&nbsp;snippet.</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>ConvertHtmlToImage.aspx.cs - </em>contains the C# code to convert HTML to Image from where the sample code above was copied
</li></ul>
<h1>More Information</h1>
<p>You can <a href="http://www.hiqpdf.com">download the HTML to Image .NET library</a> from software website. You can read more about the HTML to Image and HTML to PDF converter software on
<a href="https://code.msdn.microsoft.com/windowsapps/HTML-to-Image-Converter-e499134e/https://hiqpdf-html-to-pdf.com/">HiQPdf HTML to PDF for .NET Blog</a> page.</p>

</div>


    </div>
</body>
</html>
