<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:epxheader.4,0:sprite;/Areas/Epx/Themes/VStudio/Content:0&amp;amp;v=E23EB3163E9650C168676E9D4FBD2C95" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:epxfooter.4,0:sprite;/Areas/Epx/Themes/VStudio/Content:0&amp;amp;v=6DCDBE0D9C32BCC732F4D20DD14053D8" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>File System Tree View</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/16be2fab-2db1-4be1-a27a-07f6253a387bBrand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/vstudio/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/vstudio/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>File System Tree View</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Forms, VB.Net, System.Windows.<wbr />Forms.UserContr<wbr />ol, Visual Studio 2012
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            User Interface, Windows Forms, VB.Net, TreeView, User Control
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/12/2015</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/vstudio/File-System-Tree-View-3a28325c">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em>This sample how to build directory and file tree view with UserControl and TreeView controls in Windows Forms. Sample was originally build with VS 2008, but has converted to VS 2012.<br>
</em></p>
<h1><span>Building the Sample</span></h1>
<p><em>You need .NET 4.5 and Visual Studio 2012. No other requirements or 3rd party libraries, just extract and build.<br>
</em></p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><em>This sample solves the problem of browsing drives, folders and files by using UserControl with TreeView and creating custom TreeNode classes for each kind of an file system item. Control start from the My Computer node and under that is drives --&gt;
 folders --&gt; images and so on. There is also multiple properties to control what will be shown in the control, for example to control whether or not inactive drives are shown. Other behavior of the control is to track the changes in drive state and enable
 browsing for the content of the drive, if it becomes active. This is also controlled by property and by default it's not enabled.<br>
</em></p>
<p>The UI of the control can be seen in the following screen shot. As you can see it shows some icons for directory and files based on file extension.</p>
<p><img id="75448" src="description/file_system_tree.jpg" alt="" width="300" height="518"></p>
<p>The custom TreeNode classes are based on single base class FileSystemNode and there is one for each item shown in Control. ComputerNode, DriveNode, DirectoryNode and FileNode.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">''' &lt;summary&gt;
''' Class that represents file system tree node.
''' &lt;/summary&gt;
Friend MustInherit Class FileSystemNode
    Inherits TreeNode

    Private m_nodeType As FileSystemNodeType

    ''' &lt;summary&gt;
    ''' Initializes new instance of &lt;see cref=&quot;FileSystemNode&quot;/&gt; class.
    ''' &lt;/summary&gt;
    ''' &lt;param name=&quot;nodeType&quot;&gt;A &lt;see cref=&quot;FileSystemNodeType&quot;/&gt; of the node.&lt;/param&gt;
    Protected Sub New(ByVal nodeType As FileSystemNodeType)
        Me.New(nodeType, String.Empty)
    End Sub

    ''' &lt;summary&gt;
    ''' Initializes new instance of &lt;see cref=&quot;FileSystemNode&quot;/&gt; class.
    ''' &lt;/summary&gt;
    ''' &lt;param name=&quot;nodeType&quot;&gt;A &lt;see cref=&quot;FileSystemNodeType&quot;/&gt; of the node.&lt;/param&gt;
    ''' &lt;param name=&quot;text&quot;&gt;A text of the node.&lt;/param&gt;
    Protected Sub New(ByVal nodeType As FileSystemNodeType, ByVal text As String)
        MyBase.New(text)
        Me.m_nodeType = nodeType
    End Sub

    ''' &lt;summary&gt;
    ''' Gets the &lt;see cref=&quot;FileSystemNodeType&quot;/&gt; of the node.
    ''' &lt;/summary&gt;
    Public ReadOnly Property NodeType As FileSystemNodeType
        Get
            Return Me.m_nodeType
        End Get
    End Property

End Class</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__com">'''&nbsp;&lt;summary&gt;</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;Class&nbsp;that&nbsp;represents&nbsp;file&nbsp;system&nbsp;tree&nbsp;node.</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;&lt;/summary&gt;</span>&nbsp;
<span class="visualBasic__keyword">Friend</span>&nbsp;<span class="visualBasic__keyword">MustInherit</span>&nbsp;<span class="visualBasic__keyword">Class</span>&nbsp;FileSystemNode&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Inherits</span>&nbsp;TreeNode&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;m_nodeType&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;FileSystemNodeType&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;Initializes&nbsp;new&nbsp;instance&nbsp;of&nbsp;&lt;see&nbsp;cref=&quot;FileSystemNode&quot;/&gt;&nbsp;class.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;param&nbsp;name=&quot;nodeType&quot;&gt;A&nbsp;&lt;see&nbsp;cref=&quot;FileSystemNodeType&quot;/&gt;&nbsp;of&nbsp;the&nbsp;node.&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;<span class="visualBasic__keyword">New</span>(<span class="visualBasic__keyword">ByVal</span>&nbsp;nodeType&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;FileSystemNodeType)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Me</span>.<span class="visualBasic__keyword">New</span>(nodeType,&nbsp;<span class="visualBasic__keyword">String</span>.Empty)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;Initializes&nbsp;new&nbsp;instance&nbsp;of&nbsp;&lt;see&nbsp;cref=&quot;FileSystemNode&quot;/&gt;&nbsp;class.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;param&nbsp;name=&quot;nodeType&quot;&gt;A&nbsp;&lt;see&nbsp;cref=&quot;FileSystemNodeType&quot;/&gt;&nbsp;of&nbsp;the&nbsp;node.&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;param&nbsp;name=&quot;text&quot;&gt;A&nbsp;text&nbsp;of&nbsp;the&nbsp;node.&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;<span class="visualBasic__keyword">New</span>(<span class="visualBasic__keyword">ByVal</span>&nbsp;nodeType&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;FileSystemNodeType,&nbsp;<span class="visualBasic__keyword">ByVal</span>&nbsp;text&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">MyBase</span>.<span class="visualBasic__keyword">New</span>(text)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Me</span>.m_nodeType&nbsp;=&nbsp;nodeType&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;Gets&nbsp;the&nbsp;&lt;see&nbsp;cref=&quot;FileSystemNodeType&quot;/&gt;&nbsp;of&nbsp;the&nbsp;node.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'''&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">ReadOnly</span>&nbsp;<span class="visualBasic__keyword">Property</span>&nbsp;NodeType&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;FileSystemNodeType&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Get</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Return</span>&nbsp;<span class="visualBasic__keyword">Me</span>.m_nodeType&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Get</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Property</span>&nbsp;
&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Class</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">It is also possible to select multiple nodes by pressing the Control key when node is selected. You can get the selected directories and files in code by calling GetSelectedDirectories or GetSelectedFiles method. The multi-selection
 is demonstrated in following screen shot.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="141169" src="https://i1.code.msdn.s-msft.com/vstudio/file-system-tree-view-3a28325c/image/file/141169/1/folder_multiselection.jpg" alt="" width="624" height="518"></div>
<p>It also possible to limit tree to only select files from specified drive by setting RootDrive property to some valid path or drive. Control also has two methods, Expand and Collapse, to either expand or collapse specified path in tree. Both these features
 can seen in screenshot below.</p>
<p><img id="141171" src="https://i1.code.msdn.s-msft.com/vstudio/file-system-tree-view-3a28325c/image/file/141171/1/root_path_and_expansion.jpg" alt="" width="624" height="518"></p>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>FileSystemNode.vb - base class for the custom TreeNode classes.<br>
</em></li><li><em><em>ComputerNode.vb - computer TreeNode.</em></em> </li><li><em>DirectoryTreeNode.vb - base class for TreeNode with directories.</em> </li><li><em>DriveNode.vb - drive TreeNode.</em> </li><li><em>DirectoryNode.vb - directory TreeNode.</em> </li><li><em>FileNode.vb - file TreeNode.</em> </li><li><em>FileSystemTree.vb - the UserControl that contains the custom TreeView.</em>
</li></ul>

</div>


    </div>
</body>
</html>
