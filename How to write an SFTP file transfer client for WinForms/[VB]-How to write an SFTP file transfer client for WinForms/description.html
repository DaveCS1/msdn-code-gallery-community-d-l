<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/0aac1760-b513-488a-ba57-e31d9413a075Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to write an SFTP file transfer client for WinForms</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to write an SFTP file transfer client for WinForms</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            .NET Framework
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            SFTP, SSH
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/28/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/How-to-write-an-SFTP-file-9d177859">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p>This application demonstrates how to write an SFTP Client Windows Forms<em>.</em><em></em></p>
<h1><span>Building the Sample</span></h1>
<p>In order to build the sample project, you need the commercial <a href="http://www.componentpro.com/ftp.net/">
Ultimate SFTP</a> component which can be downloaded at <a href="http://www.componentpro.com/download/?name=UltimateFtp">
Ultimate SFTP Download Page</a>.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p>The examples demonstrates how to</p>
<ul>
<li>Login to an SFTP server </li><li>Setup proxy connection </li><li>Setup bandwidth throttling </li><li>List a directory </li><li>Transfers files asynchrounously </li><li>Upload and download multiple files </li><li>Cancel an operation (can be a file transfer or file deletion) </li><li>Handling events of the Sftp class </li><li>Display a progress bar while transferring or doing multi file operation<em></em>
</li><li>Using latest .NET <strong>async</strong> and <strong>await</strong> keywords for asynchronous operations and XXXAsync methods
</li></ul>
<p>More information about the asynchronous Download methods:</p>
<p>Use <a href="http://www.componentpro.com/doc/sftp/ComponentPro.Net.Sftp.DownloadFileAsync.htm">
DownloadFileAsync</a> methods to asynchronously download a remote file from the SFTP server. These methods download a remote file from the SFTP server asynchronously with execution occurring on a new thread, therefore they allow your next line of code to execute
 immediately.</p>
<p>In Task-based Asynchronous programs, the single asynchronous method represents the initiation and completion of an asynchronous operation. You may create the continuation code either explicitly, through methods on the Task class (for example, ContinueWith)
 or implicitly, by using language support built on top of continuations (for example,
<strong>await</strong> in C#, <strong>Await</strong> in Visual Basic).</p>
<p>In .NET 4.5 it is recommended to implement the Task-based Asynchronous Pattern.</p>
<p>In Event-based Asynchronous programs, the event <a href="http://www.componentpro.com/doc/sftp/ComponentPro.Net.Sftp.DownloadFileCompleted.htm">
DownloadFileCompleted</a> is raised when the <a href="http://www.componentpro.com/doc/sftp/ComponentPro.Net.Sftp.DownloadFileAsync.htm">
DownloadFileAsync</a> completes. In the event handler method of the <a href="http://www.componentpro.com/doc/sftp/ComponentPro.Net.Sftp.DownloadFileCompleted.htm">
DownloadFileCompleted</a>, you can check if there were any errors by using the <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.asynccompletedeventargs.error">
Error</a> property of the event data object.</p>
<p>The following code snippet demonstrates how to connect to an SFTP server.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using System;
using ComponentPro.Net;

...

// Create a new instance.
Sftp client = new Sftp();

// Connect to the SFTP server.
client.Connect(&quot;localhost&quot;);

// Authenticate.
client.Authenticate(&quot;test&quot;, &quot;test&quot;);

// ... 
 
// Download remote file '/test.dat' to 'c:\test.dat' 
long transferred = await client.DownloadFileAsync(&quot;/test.dat&quot;, &quot;c:\\test.dat&quot;);

// ...

Console.WriteLine(&quot;Bytes transferred: &quot; &#43; transferred);

// Disconnect.
client.Disconnect();</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;System;&nbsp;
<span class="cs__keyword">using</span>&nbsp;ComponentPro.Net;&nbsp;
&nbsp;
...&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;instance.</span>&nbsp;
Sftp&nbsp;client&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;Sftp();&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Connect&nbsp;to&nbsp;the&nbsp;SFTP&nbsp;server.</span>&nbsp;
client.Connect(<span class="cs__string">&quot;localhost&quot;</span>);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Authenticate.</span>&nbsp;
client.Authenticate(<span class="cs__string">&quot;test&quot;</span>,&nbsp;<span class="cs__string">&quot;test&quot;</span>);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;...&nbsp;</span>&nbsp;
&nbsp;&nbsp;
<span class="cs__com">//&nbsp;Download&nbsp;remote&nbsp;file&nbsp;'/test.dat'&nbsp;to&nbsp;'c:\test.dat'&nbsp;</span>&nbsp;
<span class="cs__keyword">long</span>&nbsp;transferred&nbsp;=&nbsp;await&nbsp;client.DownloadFileAsync(<span class="cs__string">&quot;/test.dat&quot;</span>,&nbsp;<span class="cs__string">&quot;c:\\test.dat&quot;</span>);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;...</span>&nbsp;
&nbsp;
Console.WriteLine(<span class="cs__string">&quot;Bytes&nbsp;transferred:&nbsp;&quot;</span>&nbsp;&#43;&nbsp;transferred);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Disconnect.</span>&nbsp;
client.Disconnect();</pre>
</div>
</div>
</div>
<h1>More Information</h1>
<p>More example can be found at <a href="http://www.componentpro.com/doc/sftp">http://www.componentpro.com/doc/sftp</a> and
<a href="http://www.sftpcomponent.net">http://www.sftpcomponent.net</a></p>

</div>


    </div>
</body>
</html>
