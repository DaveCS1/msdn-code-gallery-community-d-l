<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7bd86db-8a7a-43ce-8954-21f8f839f51bCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Edit XML files programatically</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Edit XML files programatically</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, XML
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            XML Programming
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">1/28/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Edit-XML-files-programatica-a10ad115">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div>Many times i have found questions regarding how to edit/update contents of xml file programatically.
<br>
This sample application is very simple, it consists of a xml file and some application code. Before going further i would like to bring focus on IEnumrable and IEnumerator interface. Hope you were knowing this but still a brief information about these :</div>
<div><br>
IEnumrable : This interface provides contract so that any engine can iterate over that object(these kind of objects are known as Collection). So, for Collection it is compulsary that it should implement IEnumrable. Actually, IEnumrable itself does not contain
 any complex thing. It only contains a method GetEnumrator, of type IEnumrator.</div>
<div>IEnumrator : This interface contains contracts that how the iteration should work i.e., logic of iteration. One of the important method in this interface is MoveNext() which gives the next item from the collection of objects.</div>
<div>Now, come to origional topic :<br>
Your XML document can be loaded in .NET object using Load method of XmlDocument class. This XmlDocument class will then represent that xml document.</div>
<div>Suppose your xml document contains :</div>
<div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>XML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">xml</span>
<pre class="hidden">&lt;appSettings&gt;
  &lt;add key=&quot;URL&quot; value=&quot;http://&quot; /&gt;
  &lt;add key=&quot;Server2ClientPort&quot; value=&quot;1234&quot; /&gt;
  &lt;add key=&quot;ServerAddress&quot; value=&quot;hello&quot; /&gt;
&lt;/appSettings&gt;</pre>
<div class="preview">
<pre class="js">&lt;appSettings&gt;&nbsp;
&nbsp;&nbsp;&lt;add&nbsp;key=<span class="js__string">&quot;URL&quot;</span>&nbsp;value=<span class="js__string">&quot;http://&quot;</span>&nbsp;/&gt;&nbsp;
&nbsp;&nbsp;&lt;add&nbsp;key=<span class="js__string">&quot;Server2ClientPort&quot;</span>&nbsp;value=<span class="js__string">&quot;1234&quot;</span>&nbsp;/&gt;&nbsp;
&nbsp;&nbsp;&lt;add&nbsp;key=<span class="js__string">&quot;ServerAddress&quot;</span>&nbsp;value=<span class="js__string">&quot;hello&quot;</span>&nbsp;/&gt;&nbsp;
&lt;/appSettings&gt;</pre>
</div>
</div>
</div>
</div>
<div>And programatically you want to change value of value attribute where key=&quot;URL&quot;.</div>
<div>So, first of all load your xml document in XmlDocument object using its Load method :</div>
<div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">XmlDocument doc = new XmlDocument();
            string path = @&quot;C:\Users\TestFolder\EditXmlDemo\EditXmlDemo

\XMLFile1.xml&quot;;
            doc.Load(path);</pre>
<div class="preview">
<pre class="js">XmlDocument&nbsp;doc&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;XmlDocument();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;path&nbsp;=&nbsp;@&quot;C:\Users\TestFolder\EditXmlDemo\EditXmlDemo&nbsp;
&nbsp;
\XMLFile1.xml&quot;;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Load(path);</pre>
</div>
</div>
</div>
</div>
<div>Then using SelectNodes method get get IEnumrator object so that using MoveNext you can iterate over that collection and fullfill your required conditions.</div>
<div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">IEnumerator ie = doc.SelectNodes(&quot;/appSettings/add&quot;).GetEnumerator();

            while (ie.MoveNext())
            {
                if ((ie.Current as XmlNode).Attributes[&quot;key&quot;].Value == 

&quot;ServerAddress&quot;)
                {
                    (ie.Current as XmlNode).Attributes[&quot;value&quot;].Value = 

&quot;hello&quot;;
                }
            }

            doc.Save(path);</pre>
<div class="preview">
<pre class="js">IEnumerator&nbsp;ie&nbsp;=&nbsp;doc.SelectNodes(<span class="js__string">&quot;/appSettings/add&quot;</span>).GetEnumerator();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">while</span>&nbsp;(ie.MoveNext())&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span><span class="js__statement">if</span>&nbsp;((ie.Current&nbsp;as&nbsp;XmlNode).Attributes[<span class="js__string">&quot;key&quot;</span>].Value&nbsp;==&nbsp;&nbsp;
&nbsp;
<span class="js__string">&quot;ServerAddress&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ie.Current&nbsp;as&nbsp;XmlNode).Attributes[<span class="js__string">&quot;value&quot;</span>].Value&nbsp;=&nbsp;&nbsp;
&nbsp;
<span class="js__string">&quot;hello&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span><span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Save(path);</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;This way you can change content of your xml files programatically.</div>
<div class="endscriptcode">Remember to add reference to&nbsp; <span style="font-family:Consolas; font-size:x-small">
<span style="font-family:Consolas; font-size:x-small"><strong><a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Xml.aspx"  title="Auto generated link to System.Xml">System.Xml</a> </strong>
and <strong><a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Collections.aspx"  title="Auto generated link to System.Collections">System.Collections</a> </strong>namespace at top and give proper path of XML file that you have to edit.</span></span>
<div><span style="font-family:Consolas; font-size:x-small"><span style="font-family:Consolas; font-size:x-small">
<div>&nbsp;</div>
</span></span><span style="font-family:Consolas; font-size:x-small"><span style="font-family:Consolas; font-size:x-small"></span></span></div>
<div>&nbsp;</div>
<h1><em>&nbsp;</em></h1>
</div>
</div>

</div>


    </div>
</body>
</html>
