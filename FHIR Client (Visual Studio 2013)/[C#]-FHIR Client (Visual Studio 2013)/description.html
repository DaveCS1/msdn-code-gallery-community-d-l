<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/67b74b86-a273-4ad7-9ed5-0f97276412eaCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>FHIR Client (Visual Studio 2013)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>FHIR Client (Visual Studio 2013)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, JSON, REST, .NET, XML, FHIR
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            C#, REST, healthcare, HttpClient, FHIR, HL7
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/15/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Client-for-HL7-FHIR-server-0709be0b">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>
<div class="endscriptcode">&nbsp;</div>
Introduction</h1>
<p>This example illustrates howto build a client for an HL7 FHIR server. It makes use of the FHIR .NET reference implementation that is available on
<a href="http://code.msdn.microsoft.com/Client-for-HL7-FHIR-server-0709be0b/https://github.com/ewoutkramer/fhir-net-api" >Github</a> and also as NuGet package. More about the HL7 FHIR standard can be found on the
<a href="http://www.hl7.org/implement/standards/fhir/" >FHIR Specification Home</a> page.&nbsp;</p>
<p>This sample implements a command line client that supports the&nbsp;following command's on a
<em><strong>FHIR&nbsp;Patient</strong>&nbsp;<strong>Resource</strong></em>:</p>
<ul>
<li><strong>register - </strong>register a new patient on the FHIR server </li><li><strong>update </strong>- update an existing patient on a FHIR server </li><li><strong>get</strong> - retrieve the patient information from a FHIR server, either current or historical data
</li><li><strong>history</strong> - retrieve the history information about a Patient resource on a FHIR server
</li><li><strong>search</strong> - search for a patient by name </li></ul>
<p>The command line client supports a help function for listing available commands and paramters.</p>
<p><img id="114265" src="description/fpat.png" alt="" width="617" height="280"></p>
<h1><span>Building the Sample</span></h1>
<p>Simply start the build command in Visual Studio. Any required NuGet packages will be automatically downloaded.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><em>The example has been created during the HL7 conference in Phoenix AZ after the connectathon. So the description is a little bit rough and will probably be updated in the near future.</em></p>
<p><em>The code provides a very lightweight framework for your own extensions. It is intended as additoinal source for educational use in addition to mentioned sources of information from HL7 and Ewout Kramer.</em></p>
<p><em>Thanks to Ewout's .NET reference implementation for the HL7 FHIR standard it is very easy to implement a client for accessing a FHIR REST service.</em></p>
<h2>Example code for retrieving Patient Resource by ID</h2>
<p>In order to retrieve a FHIR Patient Resource by its ID we need a client that is talking to the REST service offered by the FHIR Server. You can instantiate a&nbsp;FhirClient object passing the FHIR Servers REST endpoint into the constructor. The Patient
 resource is retrieved by calling the method Read with an ResourceIdentity object&nbsp;as argumen. For building the ResourceIdentity object one needs to pass the type of the resource, its logical id and optionally the version into the constructor of the ResourceIdentitiy.</p>
<p><em>&nbsp;</em></p>
<div class="scriptcode"><em>
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using Hl7.Fhir.Rest;

string url = &quot;http://spark.furore.com/fhir&quot;;
string id = &quot;1&quot;;

var client = new FhirClient(url);
var identity = ResourceIdentity.Build(&quot;Patient&quot;, id);
var patient = client.Read(identity);</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;Hl7.Fhir.Rest;&nbsp;
&nbsp;
<span class="cs__keyword">string</span>&nbsp;url&nbsp;=&nbsp;<span class="cs__string">&quot;http://spark.furore.com/fhir&quot;</span>;&nbsp;
<span class="cs__keyword">string</span>&nbsp;id&nbsp;=&nbsp;<span class="cs__string">&quot;1&quot;</span>;&nbsp;
&nbsp;
var&nbsp;client&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;FhirClient(url);&nbsp;
var&nbsp;identity&nbsp;=&nbsp;ResourceIdentity.Build(<span class="cs__string">&quot;Patient&quot;</span>,&nbsp;id);&nbsp;
var&nbsp;patient&nbsp;=&nbsp;client.Read(identity);</pre>
</div>
</div>
</em></div>
<p><em>&nbsp;</em><em>&nbsp;</em></p>
<h2>Extendig the sample code with your own CommandHander</h2>
<p>This section is specific to the sample code, it is not related to the .NET reference implementation for FHIR. The example can be easily extended with new command handler classes that implement the ICommandHandler interface.&nbsp;</p>
<p>You do so by deriving a new class from the abstract CommandHanlder class. Inside the constructor assign the command name to the property ID. Now you have to implement the two methods</p>
<ul>
<li>Execute(Arguments args) - here goes the code that interacts with the FHIR server
</li><li>ShowUsage - Write a description incuding the parameter needed by your command to the console
</li></ul>
<p>That's it!</p>

</div>


    </div>
</body>
</html>
